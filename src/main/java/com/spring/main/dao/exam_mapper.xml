<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>
<mapper namespace="com.spring.main.dao.ExamDAO">
	<insert id="examWrite" 
		useGeneratedKeys="true"
		keyProperty="combrdIdx"
		keyColumn="combrdIdx"
		parameterType="exam">
		INSERT INTO COMPANYBOARD(COMBRDIDX, SUBJECT, CONTENT,COMID) 
		VALUES(COMPANYBOARD_SEQ.NEXTVAL, #{subject}, #{content},#{comId})
	</insert>
	
	<insert id="examWriteFile">
		INSERT INTO photos (PHOTOIDX, NEWFILENAME, ORIFILENAME, COMBRDIDX) 
		VALUES (photos_seq.NEXTVAL, #{param1}, #{param2}, #{param3})
	</insert>

	<select id="examDetail" resultType="exam">
	 SELECT COMBRDIDX,SUBJECT,CONTENT,reg_date,bHit,comId FROM COMPANYBOARD WHERE COMBRDIDX=#{combrdIdx}
	</select>
	
	<update id="examUpHit" >
		UPDATE COMPANYBOARD SET bHit=bHit+1 WHERE combrdIdx=#{combrdIdx}
	</update>
	
	<update id= "examUpdate" parameterType="exam">
		UPDATE  COMPANYBOARD SET SUBJECT=#{subject}, CONTENT=#{content}
		WHERE combrdIdx=#{combrdIdx}
	</update>
	
	<update id="groupUpdateFile">
		UPDATE photos  
		SET PHOTOIDX=photos_seq.NEXTVAL, NEWFILENAME=#{param1}, ORIFILENAME =#{param2}  WHERE combrdIdx=#{param3}
	</update>
	
	<select id="examGetFileName" resultType="String">
		SELECT newFileName FROM photos WHERE combrdIdx=#{combrdIdx}
	</select>
	
	<delete id="examPhotoDel">
		DELETE FROM photos WHERE combrdIdx=#{combrdIdx}
	</delete>
	
	<delete id="examDel">
		UPDATE COMPANYBOARD SET blind='y' WHERE combrdIdx=#{combrdIdx}
	</delete>
</mapper>